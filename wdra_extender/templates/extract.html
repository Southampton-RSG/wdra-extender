{% extends 'base.html' %}

{% block extra_head %}
    <script type="text/javascript">
    $(document).ready(function() {
        {% if not extract.ready %}
            check_long_task('{{ url_for('tools.task_status', task_id=extract.uuid) }}', $('#progress_bar'), $('#progress_status'), $('#progress_message'));
        {% endif %}
    });
    </script>
{% endblock %}

{% block content %}
<h1>Extract Details</h1>

<hr>

<dl>
    <dt>UUID</dt>
    <dd>{{ extract.uuid }}</dd>

    <dt>Status</dt>
    <dd>
        {% if extract.ready %}
            Your extract has been processed and is ready to download.
        {% else %}
            Extract Status, <a id="progress_status"></a>
            <div id="progress_bar"></div>
            <a id="progress_message"></a>
        {% endif %}
    </dd>
</dl>

<hr>

{% if extract.ready %}
    <a class="btn btn-primary"
       href="{{ url_for('extract.download_extract', extract_uuid=extract.uuid) }}">
        Download
    </a>
{% else %}
    <a class="btn btn-danger" href="{{ url_for('tools.kill_task', task_id=extract.uuid) }}">
        Stop Search
    </a>
{% endif %}
<hr>
{% endblock %}