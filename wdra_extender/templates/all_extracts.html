{% extends 'base.html' %}

{% block content %}
<h1>Past Extracts</h1>

<a class="btn btn-prima`ry btn-lg btn-block" href="{{ url_for('auth.profile') }}">
    Home
</a>

{% for _extract in user_extracts %}
    <tr>
    {% if _extract.building == False %}
        <td>
            Extract: {{ _extract.uuid }}
        </td>
        <td>
            {% if _extract.is_ready() %}
                <a class="btn btn-prima`ry btn-lg btn-block"
                   href="{{ url_for('extract.download_extract', extract_uuid=_extract.uuid) }}">
                    Download
                </a>
            {% else %}
                <a class="btn btn-prima`ry btn-lg btn-block"
                   href="{{ url_for('extract.rebuild_extract', extract_uuid=_extract.uuid) }}">
                    Recreate
                </a>
            {%  endif %}
        </td>
        <td>
        {% if _extract.is_ready() %}
            <a class="btn btn-prima`ry btn-lg btn-block"
               href="{{ url_for('extract.delete_extract_data', extract_uuid=_extract.uuid) }}">
                Delete extract data.
            </a>
        {% else %}
            <button class="btn btn-info btn-lg btn-block"
            disabled>
                Extract {{ _extract.uuid }} has no output file.
            </button>
        {% endif %}
        </td>
        <td>
            <a class="btn btn-prima`ry btn-lg btn-block"
               href="{{ url_for('extract.delete_extract', extract_uuid=_extract.uuid) }}">
                Delete extract.
            </a>
        </td>
    {% else %}
        <td>
        <tr>
            <button class="btn btn-info btn-lg btn-block"
                disabled>
            Extract {{ _extract.uuid }} is in the build queue.
            </button>
            Your extract is, <a id="progress_status_{{ _extract.uuid }}"></a>, check back soon.
            <div id="progress_bar_{{ _extract.uuid }}"></div>
            Msg: <a id="progress_message_{{ _extract.uuid }}"></a>
        </tr>
        <tr>
            <a class="btn btn-prima`ry btn-lg btn-block"
               href="{{ url_for('tools.kill_task', task_id=_extract.uuid) }}">
                Delete job.
            </a>
        </tr>
        </td>
    {% endif %}
    </tr>
{% endfor %}

{% endblock %}
